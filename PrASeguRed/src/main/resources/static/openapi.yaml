openapi: 3.0.0
info:
  title: API Gestión Usuarios y Reportes
  description: |
    API para la gestión de usuarios, autenticación, reportes y notificaciones de la plataforma PRA-Segured.
    Proporciona endpoints para registro, verificación, manejo de reportes ciudadanos y sistema de comentarios.
  version: 1.6.3
  contact:
    name: Equipo PRA-Segured
    email: soporte@prasegured.co
servers:
  - url: /
    description: Servidor de desarrollo local
  - url: https://localhost:8080
    description: Servidor de pruebas con HTTPS

components:
  schemas:
    Location:
      type: object
      required:
        - latitude
        - longitude
      properties:
        latitude:
          type: number
          format: double
          example: 4.550923
        longitude:
          type: number
          format: double
          example: -75.656080
        name:
          type: string
          example: "Parque central de Armenia"

    Imagen:
      type: object
      properties:
        id:
          type: string
          description: ID único de la imagen (generado automáticamente)
          example: "60d85c3e7b4a9d001ff2a987"
        url:
          type: string
          format: uri
          description: URL o representación Base64 de la imagen
          example: "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD..."
        descripcion:
          type: string
          example: "Vista del problema desde ángulo frontal"

    Categoria:
      type: object
      required:
        - nombre
      properties:
        nombre:
          type: string
          example: "Infraestructura vial"
        descripcion:
          type: string
          example: "Problemas relacionados con calles, avenidas y señalización"

    ESTADOREPORTE:
      type: string
      enum:
        - Pendiente
        - Completado
        - Denegado
        - Eliminado
        - Espera
      description: Estado actual del reporte en el sistema

    Usuario:
      type: object
      required:
        - tpDocumento
        - documento
        - nombreCom
        - fechaNacimiento
        - ciudadResidencia
        - telefono
        - estado
        - correo
        - contraseña
      properties:
        id:
          type: string
          description: ID único del usuario (generado automáticamente)
          example: "60d85c3e7b4a9d001ff2a123"
        tpDocumento:
          type: string
          description: Tipo de documento del usuario
          enum: ["CC", "TI", "CE", "PP", "NIT"]
          example: "CC"
        documento:
          type: string
          description: Número de documento del usuario
          example: "1094957836"
        nombreCom:
          type: string
          description: Nombre completo del usuario
          example: "William Andres Ramírez Gil"
        fechaNacimiento:
          type: string
          format: date
          description: Fecha de nacimiento del usuario (YYYY-MM-DD)
          example: "1995-07-19"
        ciudadResidencia:
          type: string
          description: Ciudad de residencia del usuario
          example: "Armenia"
        direccion:
          type: string
          description: Dirección del usuario
          example: "Calle 23 #14-56, Barrio Centro"
        telefono:
          type: string
          description: Teléfono del usuario
          example: "3157894521"
        rol:
          type: string
          description: "Rol del usuario en el sistema"
          enum: ["USUARIO", "ADMIN", "MODERADOR"]
          example: "USUARIO"
          readOnly: true
        estado:
          type: string
          description: Estado de la cuenta del usuario
          enum: ["EN_ESPERA", "ACTIVO", "BLOQUEADO", "ELIMINADO"]
          example: "EN_ESPERA"
        correo:
          type: string
          format: email
          description: Correo electrónico del usuario
          example: "william19dahora@gmail.com"
        preferencias:
          type: string
          description: Preferencias de notificación del usuario
          example: "EMAIL,PUSH"
        contraseña:
          type: string
          description: Contraseña del usuario (debe cumplir con políticas de seguridad)
          format: password
          example: "Pr4S3gur3d2023!"
        locations:
          type: array
          items:
            $ref: '#/components/schemas/Location'
          description: Ubicaciones asociadas al usuario

    Verificacion:
      type: object
      required:
        - correo
      properties:
        correo:
          type: string
          format: email
          example: "william19dahora@gmail.com"
        codigoVerificacion:
          type: string
          description: Código de verificación del usuario
          example: "483921"

    Autenticacion:
      type: object
      required:
        - correo
        - contraseña
      properties:
        correo:
          type: string
          format: email
          description: Correo electrónico del usuario
          example: "william19dahora@gmail.com"
        contraseña:
          type: string
          format: password
          description: Contraseña del usuario
          example: "Pr4S3gur3d2023!"

    ActualizacionCuenta:
      type: object
      properties:
        correo:
          type: string
          format: email
          description: Nuevo correo electrónico del usuario
          example: "william.nuevo@gmail.com"
        telefono:
          type: string
          description: Nuevo teléfono del usuario
          example: "3101234567"
        direccion:
          type: string
          description: Nueva dirección del usuario
          example: "Avenida Bolívar #23-45, Edificio Altura"
        preferencias:
          type: string
          description: Nuevas preferencias de notificación
          example: "EMAIL,SMS"

    EliminacionCuenta:
      type: object
      required:
        - confirmacion
      properties:
        confirmacion:
          type: boolean
          description: Confirmación de eliminación de la cuenta
          example: true
        motivo:
          type: string
          description: Motivo de la eliminación (opcional)
          example: "Ya no uso la aplicación"

    ReporteRequest:
      type: object
      required:
        - titulo
        - descripcion
        - categoria
        - locations
      properties:
        id:
          type: string
          description: ID del reporte (opcional, generado automáticamente si no se proporciona)
          example: "60d85c3e7b4a9d001ff2a456"
        idUsuario:
          type: string
          description: ID del usuario que crea el reporte
          example: "60d85c3e7b4a9d001ff2a123"
        titulo:
          type: string
          description: Título del reporte
          example: "Hueco peligroso en la vía principal"
        descripcion:
          type: string
          description: Descripción detallada del reporte
          example: "Hay un hueco de aproximadamente 1 metro de diámetro y 20 cm de profundidad en la Av. Bolívar frente al centro comercial. Ya ha causado accidentes."
        categoria:
          type: array
          items:
            $ref: '#/components/schemas/Categoria'
          description: Categorías a las que pertenece el reporte
          example:
            - nombre: "Infraestructura vial"
              descripcion: "Problemas relacionados con calles y carreteras"
            - nombre: "Seguridad"
              descripcion: "Situaciones que ponen en riesgo a los ciudadanos"
        locations:
          $ref: '#/components/schemas/Location'
          description: Ubicación del incidente reportado
        imagenes:
          type: array
          items:
            $ref: '#/components/schemas/Imagen'
          description: Imágenes asociadas al reporte
          example:
            - url: "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAAABIykrPK..."
              descripcion: "Vista del hueco desde la acera"
            - url: "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAoLBVmPr..."
              descripcion: "Medición del diámetro del hueco"

    ReporteDTO:
      type: object
      properties:
        id:
          type: string
          description: ID único del reporte
          example: "60d85c3e7b4a9d001ff2a456"
        idUsuario:
          type: string
          description: ID del usuario que creó el reporte
          example: "60d85c3e7b4a9d001ff2a123"
        estado:
          $ref: '#/components/schemas/ESTADOREPORTE'
          example: "Pendiente"
        titulo:
          type: string
          description: Título del reporte
          example: "Hueco peligroso en la vía principal"
        fechaPublicacion:
          type: string
          format: date-time
          description: Fecha en que se publicó el reporte
          example: "2025-05-15T15:29:53.000Z"
        fechaActualizacion:
          type: string
          format: date-time
          description: Fecha de la última actualización del reporte
          example: "2025-05-16T08:45:12.000Z"
        descripcion:
          type: string
          description: Descripción detallada del reporte
          example: "Hay un hueco de aproximadamente 1 metro de diámetro y 20 cm de profundidad en la Av. Bolívar frente al centro comercial. Ya ha causado accidentes."
        likes:
          type: integer
          description: Número de "me gusta" que tiene el reporte
          example: 15
        categoria:
          type: array
          items:
            $ref: '#/components/schemas/Categoria'
          description: Categorías a las que pertenece el reporte
        location:
          $ref: '#/components/schemas/Location'
          description: Ubicación del incidente reportado
        imagenes:
          type: array
          items:
            $ref: '#/components/schemas/Imagen'
          description: Imágenes asociadas al reporte

    Comentario:
      type: object
      required:
        - reporteId
        - contenido
      properties:
        id:
          type: string
          description: ID único del comentario
          example: "60d85c3e7b4a9d001ff2b789"
        usuarioId:
          type: string
          description: ID del usuario que hace el comentario
          example: "60d85c3e7b4a9d001ff2a123"
        reporteId:
          type: string
          description: ID del reporte que se comenta
          example: "60d85c3e7b4a9d001ff2a456"
        contenido:
          type: string
          description: Contenido del comentario
          example: "Este problema lleva más de un mes y está empeorando. Recomiendo usar rutas alternas mientras se soluciona."
        fechaCreacion:
          type: string
          format: date-time
          description: Fecha de creación del comentario
          example: "2025-05-16T10:23:45.000Z"
        estado:
          type: string
          enum: [Activo, Inactivo, Borrado]
          description: Estado del comentario
          example: "Activo"

    Notificacion:
      type: object
      required:
        - usuarioId
        - titulo
        - contenido
      properties:
        id:
          type: string
          description: ID único de la notificación
          example: "60d85c3e7b4a9d001ff2c234"
        usuarioId:
          type: string
          description: ID del usuario que recibe la notificación
          example: "60d85c3e7b4a9d001ff2a123"
        titulo:
          type: string
          description: Título de la notificación
          example: "Actualización sobre su reporte"
        categoria:
          type: string
          description: Categoría de la notificación
          enum: ["Información", "Alerta", "Actualización", "Sistema"]
          example: "Actualización"
        contenido:
          type: string
          description: Contenido de la notificación
          example: "Su reporte sobre el hueco en la Av. Bolívar ha sido asignado a la Secretaría de Infraestructura. Se estima una solución en 7 días."
        leido:
          type: boolean
          description: Estado de la notificación (leído/no leído)
          example: false
        fechaCreacion:
          type: string
          format: date-time
          description: Fecha de creación de la notificación
          example: "2025-05-16T14:30:00.000Z"

    VerificationRequest:
      type: object
      required:
        - email
        - code
      properties:
        email:
          type: string
          format: email
          description: Correo electrónico del usuario
          example: "william19dahora@gmail.com"
        code:
          type: string
          description: Código de verificación de 6 dígitos
          example: "483921"
          pattern: "^[0-9]{6}$"

  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token obtenido durante el proceso de autenticación

paths:
  /registro/usuario:
    post:
      summary: Registro usuario
      description: Registro de un nuevo usuario en el sistema
      operationId: registroUsuario
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Usuario'
            examples:
              usuario:
                value:
                  tpDocumento: "CC"
                  documento: "1094957836"
                  nombreCom: "William Andres Ramírez Gil"
                  fechaNacimiento: "1995-07-19"
                  ciudadResidencia: "Armenia"
                  direccion: "Calle 23 #14-56, Barrio Centro"
                  telefono: "3157894521"
                  estado: "EN_ESPERA"
                  correo: "william19dahora@gmail.com"
                  preferencias: "EMAIL,PUSH"
                  contraseña: "Pr4S3gur3d2023!"
                  locations: [
                    {
                      "latitude": 4.550923,
                      "longitude": -75.656080,
                      "name": "Casa"
                    },
                    {
                      "latitude": 4.542567,
                      "longitude": -75.665432,
                      "name": "Trabajo"
                    }
                  ]
      responses:
        "201":
          description: Registro exitoso y envío de código de verificación.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Registro exitoso. Se ha enviado un código de verificación a su correo electrónico."
                  userId:
                    type: string
                    example: "60d85c3e7b4a9d001ff2a123"
        "400":
          description: Error de validación o datos incompletos
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Error en los datos proporcionados: correo ya registrado o campos obligatorios faltantes."
                  errors:
                    type: array
                    items:
                      type: string
                    example:
                      - "El correo electrónico ya está registrado"
                      - "La contraseña debe tener al menos 8 caracteres"

  /email:
    post:
      summary: Código verificación - envío
      description: Envío de correo con el código de verificación al usuario registrado
      operationId: codigoVerificacionEnvio
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Verificacion'
            examples:
              envioVerificacion:
                value:
                  correo: "william19dahora@gmail.com"
      responses:
        "200":
          description: Código enviado correctamente.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Código de verificación enviado correctamente a william19dahora@gmail.com."
                  expiresIn:
                    type: integer
                    example: 300
                    description: "Tiempo de expiración del código en segundos (5 minutos)"

  /auth/login:
    post:
      summary: Inicio sesión
      description: Autenticación de usuario por correo y contraseña
      operationId: inicioSesion
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Autenticacion'
            examples:
              credenciales:
                value:
                  correo: "william19dahora@gmail.com"
                  contraseña: "Pr4S3gur3d2023!"
      responses:
        "200":
          description: Inicio de sesión exitoso.
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
                    description: Token de autenticación JWT
                    example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ3aWxsaWFtMTlkYWhvcmFAZ21haWwuY29tIiwiaWQiOiI2MGQ4NWMzZTdiNGE5ZDAwMWZmMmExMjMiLCJyb2wiOiJVU1VBUklPIiwiaWF0IjoxNjI1NzY5MzkzLCJleHAiOjE2MjU4NTU3OTN9.example_token"
                  user:
                    type: object
                    properties:
                      id:
                        type: string
                        example: "60d85c3e7b4a9d001ff2a123"
                      nombre:
                        type: string
                        example: "William Andres"
                      rol:
                        type: string
                        example: "USUARIO"
        "401":
          description: Credenciales incorrectas.
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Credenciales incorrectas."

  /cuenta:
    patch:
      summary: Actualización cuenta
      description: Modificación de datos personales
      operationId: cuentaActualizacion
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ActualizacionCuenta'
            examples:
              actualizarCuenta:
                value:
                  correo: "william.nuevo@gmail.com"
                  telefono: "3101234567"
                  direccion: "Avenida Bolívar #23-45, Edificio Altura"
                  preferencias: "EMAIL,SMS"
      responses:
        "200":
          description: Datos actualizados correctamente.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Datos actualizados correctamente."
                  user:
                    $ref: '#/components/schemas/Usuario'
        "401":
          description: No autenticado o token inválido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Token inválido o expirado."

    delete:
      summary: Eliminación cuenta
      description: Eliminación definitiva de la cuenta del usuario
      operationId: cuentaEliminacion
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EliminacionCuenta'
            examples:
              eliminarCuenta:
                value:
                  confirmacion: true
                  motivo: "Ya no uso la aplicación"
      responses:
        "200":
          description: Cuenta eliminada.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Su cuenta ha sido eliminada correctamente. Agradecemos su tiempo con nosotros."
        "401":
          description: No autenticado o token inválido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Token inválido o expirado."

  /reportes:
    get:
      summary: Obtener todos los reportes
      description: Recupera una lista de todos los reportes disponibles
      operationId: obtenerTodosReportes
      security:
        - bearerAuth: []
      parameters:
        - name: estado
          in: query
          description: Filtrar por estado de reporte
          required: false
          schema:
            type: string
            enum: [Pendiente, Completado, Denegado, Espera]
        - name: categoria
          in: query
          description: Filtrar por categoría
          required: false
          schema:
            type: string
        - name: page
          in: query
          description: Número de página para paginación
          required: false
          schema:
            type: integer
            default: 0
        - name: size
          in: query
          description: Tamaño de página para paginación
          required: false
          schema:
            type: integer
            default: 10
      responses:
        "200":
          description: Lista de reportes obtenida exitosamente
          content:
            application/json:
              schema:
                type: object
                properties:
                  content:
                    type: array
                    items:
                      $ref: '#/components/schemas/ReporteDTO'
                  totalPages:
                    type: integer
                    example: 5
                  totalElements:
                    type: integer
                    example: 42
                  last:
                    type: boolean
                    example: false
                  size:
                    type: integer
                    example: 10
        "401":
          description: No autenticado o token inválido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Token inválido o expirado."

    post:
      summary: Creación reporte
      description: Creación de un nuevo reporte en el sistema
      operationId: reporteCreacion
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ReporteRequest'
            examples:
              nuevoReporte:
                value:
                  titulo: "Hueco peligroso en la vía principal"
                  descripcion: "Hay un hueco de aproximadamente 1 metro de diámetro y 20 cm de profundidad en la Av. Bolívar frente al centro comercial. Ya ha causado accidentes a motociclistas y biciusuarios."
                  categoria: [
                    {
                      "nombre": "Infraestructura vial",
                      "descripcion": "Problemas relacionados con calles y carreteras"
                    },
                    {
                      "nombre": "Seguridad",
                      "descripcion": "Situaciones que ponen en riesgo a los ciudadanos"
                    }
                  ]
                  locations: {
                    "latitude": 4.550923,
                    "longitude": -75.656080,
                    "name": "Av. Bolívar frente al Portal del Quindío"
                  }
                  imagenes: [
                    {
                      "url": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBoRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAAExAAIAAAASAAAATgAAAAAAAABgAAAAAQAAAGAAAAABUGFpbnQuTkVUIHYzLjUuMTAA/9sAQwAEAgMDAwIEAwMDBAQEBAUJBgUFBQULCAgGCQ0LDQ0NCwwMDhAUEQ4PEw8MDBIYEhMVFhcXFw4RGRsZFhoUFhcW/9sAQwEEBAQFBQUKBgYKFg8MDxYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYW/8AAEQgAZABkAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicQgUKjKBCRVCsRIjM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD7LooooAKKKKACiiigAooooAKKKOtABRTWdUGWIUe9Y2s+KtL0aVYbiZmmf7sUYLE/l0/GplOMF7zLhTnUdoq5uVXv...",
                      "descripcion": "Vista del hueco desde la acera"
                    },
                    {
                      "url": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBoRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAAExAAIAAAASAAAATgAAAAAAAABgAAAAAQAAAGAAAAABUGFpbnQuTkVUIHYzLjUuMTAA/9sAQwAEAgMDAwIEAwMDBAQEBAUJBgUFBQULCAgGCQ0LDQ0NCwwMDhAUEQ4PEw8MDBIYEhMVFhcXFw4RGRsZFhoUFhcW/9sAQwEEBAQFBQUKBgYKFg8MDxYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYW/8AAEQgAZABkAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicQgUKjKBCRVCsRIjM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD7LooooAKKKKACiiigAooooAKKKOtABRTWdUGWIUe9Y2s+KtL0aVYbiZmmf7sUYLE/l0/GplOMF7zLhTnUdoq5uVXv...",
                      "descripcion": "Medición del diámetro del hueco"
                    }
                  ]
      responses:
        "201":
          description: Reporte creado exitosamente.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Reporte creado exitosamente."
                  reporte:
                    $ref: '#/components/schemas/ReporteDTO'
        "401":
          description: No autenticado o token inválido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Token inválido o expirado."
        "400":
          description: Datos del reporte inválidos o encabezado requerido faltante
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Solicitud inválida: datos insuficientes o incorrectos."
                  details:
                    type: array
                    items:
                      type: string
                    example:
                      - "El título no puede estar vacío"
                      - "La descripción debe tener al menos 20 caracteres"

  /reportes/{id}:
    get:
      summary: Obtener un reporte específico
      description: Recupera un reporte por su ID
      operationId: obtenerReportePorId
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            description: ID del reporte a obtener
            example: "60d85c3e7b4a9d001ff2a456"
      responses:
        "200":
          description: Reporte recuperado exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ReporteDTO'
        "401":
          description: No autenticado o token inválido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Token inválido o expirado."
        "404":
          description: Reporte no encontrado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Reporte no encontrado con ID: 60d85c3e7b4a9d001ff2a456"

    put:
      summary: Actualización reporte
      description: Modificación de un reporte existente
      operationId: reporteActualizacion
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            description: ID del reporte a actualizar
            example: "60d85c3e7b4a9d001ff2a456"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ReporteRequest'
            examples:
              actualizarReporte:
                value:
                  titulo: "URGENTE: Hueco peligroso en la vía principal - Accidente reciente"
                  descripcion: "Hay un hueco de aproximadamente 1 metro de diámetro y 20 cm de profundidad en la Av. Bolívar frente al centro comercial. Actualización: Hoy hubo un accidente donde una motocicleta cayó en el hueco. Se necesita intervención urgente."
                  categoria: [
                    {
                      "nombre": "Infraestructura vial",
                      "descripcion": "Problemas relacionados con calles y carreteras"
                    },
                    {
                      "nombre": "Seguridad",
                      "descripcion": "Situaciones que ponen en riesgo a los ciudadanos"
                    },
                    {
                      "nombre": "Emergencia",
                      "descripcion": "Situación que requiere atención inmediata"
                    }
                  ]
                  locations: {
                    "latitude": 4.550923,
                    "longitude": -75.656080,
                    "name": "Av. Bolívar frente al Portal del Quindío"
                  }
                  imagenes: [
                    {
                      "url": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBoRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAAExAAIAAAASAAAATgAAAAAAAABgAAAAAQAAAGAAAAABUGFpbnQuTkVUIHYzLjUuMTAA/9sAQwAEAgMDAwIEAwMDBAQEBAUJBgUFBQULCAgGCQ0LDQ0NCwwMDhAUEQ4PEw8MDBIYEhMVFhcXFw4RGRsZFhoUFhcW/9sAQwEEBAQFBQUKBgYKFg8MDxYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYW/8AAEQgAZABkAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicQgUKjKBCRVCsRIjM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD7LooooAKKKKACiiigAooooAKKKOtABRTWdUGWIUe9Y2s+KtL0aVYbiZmmf7sUYLE/l0/GplOMF7zLhTnUdoq5uVXv...",
                      "descripcion": "Vista del hueco desde la acera"
                    },
                    {
                      "url": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBoRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAAExAAIAAAASAAAATgAAAAAAAABgAAAAAQAAAGAAAAABUGFpbnQuTkVUIHYzLjUuMTAA/9sAQwAEAgMDAwIEAwMDBAQEBAUJBgUFBQULCAgGCQ0LDQ0NCwwMDhAUEQ4PEw8MDBIYEhMVFhcXFw4RGRsZFhoUFhcW/9sAQwEEBAQFBQUKBgYKFg8MDxYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYW/8AAEQgAZABkAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicQgUKjKBCRVCsRIjM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD7LooooAKKKKACiiigAooooAKKKOtABRTWdUGWIUe9Y2s+KtL0aVYbiZmmf7sUYLE/l0/GplOMF7zLhTnUdoq5uVXv...",
                      "descripcion": "Medición del diámetro del hueco"
                    },
                    {
                      "url": "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBoRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAAExAAIAAAASAAAATgAAAAAAAABgAAAAAQAAAGAAAAABUGFpbnQuTkVUIHYzLjUuMTAA/9sAQwAEAgMDAwIEAwMDBAQEBAUJBgUFBQULCAgGCQ0LDQ0NCwwMDhAUEQ4PEw8MDBIYEhMVFhcXFw4RGRsZFhoUFhcW/9sAQwEEBAQFBQUKBgYKFg8MDxYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYW/8AAEQgAZABkAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicQgUKjKBCRVCsRIjM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD7LooooAKKKKACiiigAooooAKKKOtABRTWdUGWIUe9Y2s+KtL0aVYbiZmmf7sUYLE/l0/GplOMF7zLhTnUdoq5uVXv...",
                      "descripcion": "Accidente de motocicleta causado por el hueco"
                    }
                  ]
      responses:
        "200":
          description: Reporte actualizado.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Reporte actualizado exitosamente."
                  reporte:
                    $ref: '#/components/schemas/ReporteDTO'
        "401":
          description: No autenticado o token inválido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Token inválido o expirado."
        "404":
          description: Reporte no encontrado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Reporte no encontrado con ID: 60d85c3e7b4a9d001ff2a456"

    delete:
      summary: Eliminación reporte
      description: Marca el reporte como eliminado (cambia su estado a Eliminado)
      operationId: reporteEliminacion
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            description: ID del reporte a eliminar
            example: "60d85c3e7b4a9d001ff2a456"
      responses:
        "200":
          description: Reporte eliminado correctamente.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Reporte eliminado correctamente."
                  id:
                    type: string
                    example: "60d85c3e7b4a9d001ff2a456"
        "401":
          description: No autenticado o token inválido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Token inválido o expirado."
        "404":
          description: Reporte no encontrado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Reporte no encontrado con ID: 60d85c3e7b4a9d001ff2a456"

  /reportes/{id}/completar:
    put:
      summary: Marcar reporte como completado
      description: Cambia el estado del reporte a Completado
      operationId: marcarReporteComoCompletado
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            description: ID del reporte a marcar como completado
            example: "60d85c3e7b4a9d001ff2a456"
      responses:
        "200":
          description: Reporte marcado como completado correctamente.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Reporte marcado como completado exitosamente."
                  reporte:
                    $ref: '#/components/schemas/ReporteDTO'
        "401":
          description: No autenticado o token inválido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Token inválido o expirado."
        "404":
          description: Reporte no encontrado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Reporte no encontrado con ID: 60d85c3e7b4a9d001ff2a456"

  /reportes/{id}/denegar:
    put:
      summary: Marcar reporte como denegado
      description: Cambia el estado del reporte a Denegado
      operationId: marcarReporteComoDenegado
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            description: ID del reporte a marcar como denegado
            example: "60d85c3e7b4a9d001ff2a456"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                motivo:
                  type: string
                  description: Motivo por el que se deniega el reporte
            examples:
              denegarReporte:
                value:
                  motivo: "El reporte no contiene información suficiente para ser procesado. Por favor, proporcione más detalles sobre la ubicación exacta."
      responses:
        "200":
          description: Reporte marcado como denegado correctamente.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Reporte marcado como denegado."
                  reporte:
                    $ref: '#/components/schemas/ReporteDTO'
        "401":
          description: No autenticado o token inválido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Token inválido o expirado."
        "404":
          description: Reporte no encontrado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Reporte no encontrado con ID: 60d85c3e7b4a9d001ff2a456"

  /comentarios:
    post:
      summary: Creación comentario
      description: Creación de un nuevo comentario en un reporte
      operationId: comentarioCreacion
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Comentario'
            examples:
              nuevoComentario:
                value:
                  reporteId: "60d85c3e7b4a9d001ff2a456"
                  contenido: "Ya he notificado este problema a la línea de atención 123 y me confirman que están priorizando la intervención dado el reciente accidente."
      responses:
        "201":
          description: Comentario creado exitosamente.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Comentario creado exitosamente."
                  comentario:
                    $ref: '#/components/schemas/Comentario'
        "401":
          description: No autenticado o token inválido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Token inválido o expirado."

  /comentario/{id}:
    patch:
      summary: Actualización comentario
      description: Modificación de un comentario existente
      operationId: comentarioActualizacion
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            description: ID del comentario a actualizar
            example: "60d85c3e7b4a9d001ff2b789"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Comentario'
            examples:
              actualizarComentario:
                value:
                  contenido: "Ya he notificado este problema a la línea de atención 123 y me confirman que están priorizando la intervención. Me informan que la reparación será realizada mañana en la mañana."
      responses:
        "200":
          description: Comentario actualizado.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Comentario actualizado exitosamente."
                  comentario:
                    $ref: '#/components/schemas/Comentario'
        "401":
          description: No autenticado o token inválido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Token inválido o expirado."
        "404":
          description: Comentario no encontrado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Comentario no encontrado con ID: 60d85c3e7b4a9d001ff2b789"

    delete:
      summary: Eliminación comentario
      description: Eliminación definitiva del comentario
      operationId: comentarioEliminacion
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            description: ID del comentario a eliminar
            example: "60d85c3e7b4a9d001ff2b789"
      responses:
        "200":
          description: Comentario eliminado correctamente.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Comentario eliminado correctamente."
                  id:
                    type: string
                    example: "60d85c3e7b4a9d001ff2b789"
        "401":
          description: No autenticado o token inválido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Token inválido o expirado."
        "404":
          description: Comentario no encontrado
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Comentario no encontrado con ID: 60d85c3e7b4a9d001ff2b789"

  /comentario/usuario/{usuarioId}:
    get:
      summary: Obtener comentarios por usuario
      description: Obtiene todos los comentarios realizados por un usuario específico
      operationId: obtenerComentariosPorUsuario
      security:
        - bearerAuth: []
      parameters:
        - name: usuarioId
          in: path
          required: true
          schema:
            type: string
            description: ID del usuario cuyos comentarios se desean obtener
            example: "60d85c3e7b4a9d001ff2a123"
      responses:
        "200":
          description: Comentarios obtenidos correctamente.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Comentario'
        "401":
          description: No autenticado o token inválido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Token inválido o expirado."

  /comentario:
    get:
      summary: Obtener todos los comentarios
      description: Obtiene todos los comentarios realizados por todos los usuarios
      operationId: obtenerTodosLosComentarios
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          description: Número de página para paginación
          required: false
          schema:
            type: integer
            default: 0
        - name: size
          in: query
          description: Tamaño de página para paginación
          required: false
          schema:
            type: integer
            default: 20
      responses:
        "200":
          description: Todos los comentarios obtenidos correctamente.
          content:
            application/json:
              schema:
                type: object
                properties:
                  content:
                    type: array
                    items:
                      $ref: '#/components/schemas/Comentario'
                  totalPages:
                    type: integer
                    example: 3
                  totalElements:
                    type: integer
                    example: 45
                  last:
                    type: boolean
                    example: false
                  size:
                    type: integer
                    example: 20
        "401":
          description: No autenticado o token inválido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Token inválido o expirado."

  /notificacion:
    post:
      summary: Enviar notificación
      description: Enviar una notificación a un usuario o admin
      operationId: enviarNotificacion
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Notificacion'
            examples:
              nuevaNotificacion:
                value:
                  usuarioId: "60d85c3e7b4a9d001ff2a123"
                  titulo: "Su reporte ha sido asignado"
                  categoria: "Actualización"
                  contenido: "Su reporte sobre el hueco en la Av. Bolívar ha sido asignado a la Secretaría de Infraestructura. Se estima una solución en 72 horas."
                  leido: false
      responses:
        "201":
          description: Notificación enviada correctamente.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Notificación enviada correctamente."
                  notificacion:
                    $ref: '#/components/schemas/Notificacion'
        "401":
          description: No autenticado o token inválido
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Token inválido o expirado."

  /notificaciones/usuario/{usuarioId}:
    get:
      summary: Obtener notificaciones por usuario
      description: Obtiene todas las notificaciones enviadas a un usuario específico
      operationId: obtenerNotificacionesPorUsuario
      security:
        - bearerAuth: []
      parameters:
        - name: usuarioId
          in: path
          required: true
          schema:
            type: string
            description: ID del usuario cuyas notificaciones se desean obtener
            example: "60d85c3e7b4a9d001ff2a123"
        - name: leido
          in: query
          required: false
          schema:
            type: boolean
            description: Filtrar por estado de lectura
        - name: page
          in: query
          description: Número de página para paginación
          required: false
          schema:
            type: integer
            default: 0
        - name: size
          in: query
          description: Tamaño de página para paginación
